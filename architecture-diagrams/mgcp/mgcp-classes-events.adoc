[plantuml,file="mgcp-classes-events.png"]
--
class NotificationRequestCommand {
}

class MgcpEndpoint {
- NotificationRequest notificationRequest
+ requestNotification(NotificationRequest)
}

class NotificationRequest {
- Queue<Signal> requestedSignals
- String[] requestedEvents
- NotifiedEntity notifiedEntity
- AtomicBoolean executing
+ execute()
+ cancel()
+ isEventRegistered(String)
}

abstract class MgcpPackage {
- String symbol
- List<String> signals
}

class AudioPackage {
+ String PACKAGE_NAME = "AU"
}

interface MgcpEvent {
+ fire()
}

abstract class AbstractMgcpEvent {
- String symbol
- Map<String, String> parameters
- List<MgcpEventListener> listeners
- AtomicBoolean fired
+ getSymbol()
+ getParameter(String)
+ addParameter(String, String)
- clean()
}

class OperationComplete {

}

class OperationFailure {

}

interface MgcpEventListener {
+ onMgcpEvent(MgcpEvent)
}

interface MgcpSignalFactory {
+ MgcpSignal produce(String)
}

interface MgcpSignal {
+ execute()
+ cancel()
}

abstract class AbstractMgcpSignal {
- String package
- String symbol
- Map<String, String> parameters
+ addParameter(String, String)
+ String getParameter()
# boolean isParameterSupported(String)
}

NotificationRequestCommand -> MgcpEndpoint : submit
(NotificationRequestCommand,MgcpEndpoint) .. NotificationRequest
NotificationRequest *-> MgcpSignal : execute or cancel
MgcpEndpoint -|> MgcpEventListener
MgcpSignal <|-- AbstractMgcpSignal
AbstractMgcpSignal <|-- PlayAnnouncement
AbstractMgcpSignal <|-- PlayCollect
AbstractMgcpSignal <|-- PlayRecord
MgcpSignal -> MgcpEvent : fires
MgcpEventListener <-- MgcpEvent : notifies
MgcpEvent <|-- AbstractMgcpEvent
AbstractMgcpEvent <|-- OperationComplete
AbstractMgcpEvent <|-- OperationFailure

MgcpSignal <-- MgcpSignalFactory : produces
MgcpSignalFactory <-- MgcpPackage
MgcpPackage <|-- AudioPackage
--